const e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],t=new class{constructor(t=e){this.board=t,this.score=0,this.status="idle"}Slide(){let e=document.querySelector(".game-score"),t=0,s=this.board.map(e=>e.map((t,s)=>e[s]));for(let e=0;e<4;e++){let s;for(let r=1;r<4;r++)if(this.board[e][r]>0){let o=0;for(;0===this.board[e][r-o-1];)o++;this.board[e][r]===this.board[e][r-o-1]&&r-o-1!==s?(s=r-++o,this.board[e][r-o]=this.board[e][r]+this.board[e][r-o],t+=this.board[e][r-o]):this.board[e][r-o]=this.board[e][r],r-o!==r&&(this.board[e][r]=0),this.board.flat().includes(2048)&&(this.status="win")}}JSON.stringify(this.board)!==JSON.stringify(s)&&(this.#e(),e.innerHTML=`${+e.innerHTML+t}`)}moveLeft(){this.Slide(),this.setBoard()}moveRight(){this.#t(),this.Slide(),this.#t(),this.setBoard()}moveUp(){this.#s(),this.Slide(),this.#s(),this.setBoard()}moveDown(){this.#s(),this.moveRight(),this.#s(),this.setBoard()}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.status="playing",this.#e(),this.#e()}restart(){let e=document.querySelector(".game-score");this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.start(),this.score=0,e.innerHTML=0}setBoard(){let e=document.querySelectorAll(".field-cell"),t=0;for(let s=0;s<4;s++)for(let r=0;r<4;r++){let o=this.board[s][r];0!==o?(e[t].textContent=o,e[t].className=` field-cell field-cell--${o}`):(e[t].className="field-cell",e[t].textContent=""),t++}}#t(){this.board.forEach(e=>e.reverse())}#s(){this.board=this.board.map((e,t)=>{let s=[];for(let r=0;r<e.length;r++)s.push(this.board[r][t]);return s})}#e(){let e,t;let s=Math.ceil(10*Math.random())>9?4:2,r=()=>Math.floor(4*Math.random()),o=()=>{e=r(),t=r(),0===this.board[e][t]?(this.board[e][t]=s,this.setBoard()):o()};o()}},s=document.querySelector(".button"),r=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),a=document.querySelector(".message-start");function i(e){switch(e.key){case"ArrowUp":t.moveUp();break;case"ArrowRight":t.moveRight();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft()}"win"===t.getStatus()&&(d(),r.classList.remove("hidden"),document.removeEventListener("keydown",i)),n()&&(d(),o.classList.remove("hidden"),document.removeEventListener("keydown",i))}const d=()=>{r.className="message message-win hidden",a.className="message message-start hidden",o.className="message message-lose hidden"},n=()=>{for(let e of t.board.flat())if(0===e)return!1;for(let e=0;e<=3;e++)for(let s=0;s<=2;s++)if(t.board[e][s]===t.board[e][s+1])return!1;for(let e=0;e<=3;e++)for(let s=0;s<=2;s++)if(t.board[s][e]===t.board[s+1][e])return!1;return!0};s.addEventListener("click",()=>{switch(t.getStatus()){case"idle":d(),s.innerHTML="restart",s.classList.replace("start","restart"),document.addEventListener("keydown",i),t.start();break;case"playing":case"win":case"lose":d(),t.restart()}});
//# sourceMappingURL=index.07f07f97.js.map
